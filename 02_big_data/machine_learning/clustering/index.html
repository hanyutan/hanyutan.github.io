<!DOCTYPE html>
<html lang="en">
<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<title>Clustering - Keep Learning</title>
<meta name="description" content="Han Yutan">
<meta name="generator" content="Hugo 0.58.1" />
<link href="https://hanyutan.gitee.ioindex.xml" rel="alternate" type="application/rss+xml">
<link rel="canonical" href="https://hanyutan.gitee.io/02_big_data/machine_learning/clustering/">
<link rel="stylesheet" href="https://hanyutan.gitee.io/css/theme.min.css">
<script src="https://use.fontawesome.com/releases/v5.0.6/js/all.js"></script>
<link rel="stylesheet" href="https://hanyutan.gitee.io/css/chroma.min.css">
<script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
<script src="https://hanyutan.gitee.io/js/functions.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery.easing@1.4.1/jquery.easing.min.js"></script>
<script src="https://hanyutan.gitee.io/js/jquery.backtothetop/jquery.backtothetop.min.js"></script><script type="text/x-mathjax-config">
MathJax.Hub.Config({
    jax: ["input/TeX", "output/HTML-CSS"],
    tex2jax: {
        inlineMath: [ ['$', '$'] ],
        displayMath: [ ['$$', '$$']],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    messageStyle: "none",
    "HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"] }
});
</script>
<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

</head>
<body>
<div class="container"><header>
<h1>Keep Learning</h1>

 <span class="version">Version 1.0</span>
<a href="https://gitee.com/hanyutan" class="github"><i class="fab fa-github"></i></a>
<p class="description">Han Yutan</p>

</header>
<div class="menu">
<nav>
<ul>
<li><a href="/">Home</a></li>
<li><a href="https://www.instagram.com/philoartist97/">Instagram</a></li>
<li><a href="/default_post/goisforlovers/">(Hu)go Template Primer</a></li>
<li><a href="/about/">About Hugo</a></li>
<li><a href="/default_post/hugoisforlovers/">Getting Started with Hugo</a></li><li class="parent"><a href="">Tutorials<i class="fas fa-angle-right"></i></a>
<ul class="sub-menu">
<li class="child"><a href="/default_post/creating-a-new-theme/">Creating a New Theme</a></li>
<li class="child"><a href="/default_post/migrate-from-jekyll/">Migrating from Jekyll</a></li>
</ul>
</li></ul>
</nav>
</div>
<div class="content-container">
<main><h1>Clustering</h1>

<h2 id="理论部分">理论部分</h2>

<h3 id="常用的距离计算方法">常用的距离计算方法：</h3>

<table>
<thead>
<tr>
<th align="center">计算方法</th>
<th align="center">公式</th>
</tr>
</thead>

<tbody>
<tr>
<td align="center">曼哈顿距离($L_1$范数)</td>
<td align="center">$d(X,Y)=\sum _{i=1}^n\vert x_i-y_i\vert $</td>
</tr>

<tr>
<td align="center">欧氏距离($L_2$范数)</td>
<td align="center">$d(X,Y)=\sqrt{ \sum _{i=1}^n(x_i-y_i)^2 }$</td>
</tr>

<tr>
<td align="center">明氏距离($L_p$范数)</td>
<td align="center">$d(X,Y)=(\sum _{i=1}^n\vert x_i-y_i\vert ^p)^{ \frac{1}{p} }$</td>
</tr>

<tr>
<td align="center">马氏距离</td>
<td align="center">$d(X,Y)=\sqrt { (X-Y)^T\Sigma ^{-1}(X-Y) }$</td>
</tr>
</tbody>
</table>

<p>在更高维空间中，欧氏距离的意义变小，应该使用其他距离度量</p>

<h3 id="聚类算法">聚类算法</h3>

<ul>
<li>划分聚类 partitional clustering<br>
将数据集划分为一系列的簇，每个点唯一地属于一个簇，并且不存在独立成簇的点。e.g.：k均值<br>
注意：初始中心点的选择（敏感）、k值的选择、距离计算方法的选择</li>
<li>谱聚类 spectral clustering</li>
<li>层次聚类 hierarchical clustering</li>
</ul>

<h3 id="评估方法">评估方法</h3>

<p>内聚性 cohesiveness：簇内部紧密，即在每个簇中个体离中心点更近<br>
$$SSE = \Sigma _{i=1}^k\Sigma _{j=1}^{n_i}\Vert x_j^i-\mu_i\Vert ^2$$</p>

<p>离散型 separateness：簇与簇之间分散，差异更大<br>
$$\Sigma _{i=1}^k \Vert \mu-\mu_i\Vert ^2$$</p>

<p><strong>silhouette指数</strong>：簇内距离小，簇间距离大</p>

<p>簇C中个体x与C中其他成员的平均距离：$a(x)=\frac{1}{\vert C\vert-1}\Sigma _{y\in C, y\neq x}\Vert x-y\Vert ^2$</p>

<p>个体x与其他簇的最近平均距离：$b(x)=min_{G\ne C}\frac{1}{\vert G\vert}\Sigma _{y\in G}\Vert x-y\Vert ^2$</p>

<p>我们只关注$a(x)&lt;b(x)$的情况，令$s(x)=\frac{b(x)-a(x)}{max(b(x),a(x))}$
$$ silhouette指数 = \frac{1}{n}\Sigma_xs(x)\in[-1,1]$$
silhouette指数越大说明聚类效果越好</p>

<h2 id="代码部分">代码部分</h2>

<h3 id="kmeans">Kmeans</h3>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="c1"># split dataset</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&#34;Train size: &#34;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s2">&#34;, Test size: &#34;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>


<span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">KMeans</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">metrics</span>

<span class="n">k_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span>   <span class="c1"># 几种k值选项</span>
<span class="n">plot_options</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;r.&#39;</span><span class="p">,</span><span class="s1">&#39;b.&#39;</span><span class="p">,</span><span class="s1">&#39;g.&#39;</span><span class="p">,</span><span class="s1">&#39;y.&#39;</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">k_list</span><span class="p">),</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">k</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">k_list</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span> <span class="o">=</span> <span class="n">k</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
    <span class="n">y_train_hat</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">labels_</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_train</span><span class="p">[</span><span class="n">y_train_hat</span><span class="o">==</span><span class="n">c</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">X_train</span><span class="p">[</span><span class="n">y_train_hat</span><span class="o">==</span><span class="n">c</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">plot_options</span><span class="p">[</span><span class="n">c</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x1&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;x2&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;K = </span><span class="si">%s</span><span class="s1">, Silhouette Coefficient = </span><span class="si">%.03f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span> <span class="n">k</span><span class="p">,</span> <span class="n">metrics</span><span class="o">.</span><span class="n">silhouette_score</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train_hat</span> <span class="p">,</span><span class="n">metric</span><span class="o">=</span><span class="s1">&#39;euclidean&#39;</span><span class="p">)))</span>

<span class="c1"># Silhouette Coefficient 越大越好</span>

<span class="n">centers</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">cluster_centers_</span>
<span class="n">y_test_hat</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&#34;Test set accuracy score: {:.5f}&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test_hat_adj</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)))</span>     <span class="c1"># y_test_hat_adj注意调整顺序以匹配原始label</span></code></pre></div><div class="edit-meta">
Last updated on 11 Oct 2019


<br>
Published on 11 Oct 2019
<br><a href="https://gitee.com/hanyutan/hanyutan/edit/master/content/02_big_data%5cmachine_learning%5cclustering.md" class="edit-page"><i class="fas fa-pen-square"></i> Edit on GitHub</a></div><nav class="pagination"><a class="nav nav-prev" href="/02_big_data/machine_learning/train_test/" title="Train &amp; Test"><i class="fas fa-arrow-left" aria-hidden="true"></i> Prev - Train &amp; Test</a>
<a class="nav nav-next" href="/02_big_data/machine_learning/naive_bayes/" title="Naive Bayes">Next - Naive Bayes <i class="fas fa-arrow-right" aria-hidden="true"></i></a>
</nav><footer><p class="powered">Powered by <a href="https://gohugo.io">Hugo</a>. Theme by <a href="https://themes.gohugo.io/hugo-theme-techdoc/">TechDoc</a>. Designed by <a href="https://github.com/thingsym/hugo-theme-techdoc">Thingsym</a>.</p>
</footer>
</main><div class="sidebar">
<nav>
<ul>
<li class=""><a href="https://hanyutan.gitee.io">Home</a></li>

<li class=""><a href="/01_course/">Course</a>
<ul class="">
<li class=""><a href="/01_course/r_cheat_sheet/">R Cheat-Sheet</a></li>
<li class=""><a href="/01_course/spark/">Spark</a></li>
<li class=""><a href="/01_course/latex/">Latex</a></li>

<li class=""><a href="/01_course/python_cheat_sheet/">Python Cheat Sheet</a>
<ul class="">
<li class=""><a href="/01_course/python_cheat_sheet/basic/">Basic</a></li>
<li class=""><a href="/01_course/python_cheat_sheet/pandas/">Pandas</a></li>
<li class=""><a href="/01_course/python_cheat_sheet/plot/">Plot</a></li>
<li class=""><a href="/01_course/python_cheat_sheet/numpy/">Numpy</a></li>
<li class=""><a href="/01_course/python_cheat_sheet/data_preprocessing/">Data Pre-processing</a></li>
</ul>
  
</li>

<li class=""><a href="/01_course/financial_risk_management/">Financial Risk Management</a>
<ul class="">
<li class=""><a href="/01_course/financial_risk_management/markowitz/">Markowitz</a></li>
<li class=""><a href="/01_course/financial_risk_management/binomial_trees/">Binomial Trees</a></li>
<li class=""><a href="/01_course/financial_risk_management/bsm_model/">BSM Model</a></li>
<li class=""><a href="/01_course/financial_risk_management/greeks/">Hedging with the Greeks</a></li>
<li class=""><a href="/01_course/financial_risk_management/exam/">Exam</a></li>
</ul>
  
</li>
</ul>
  
</li>

<li class="parent"><a href="/02_big_data/">Big Data Analysis</a>
<ul class="sub-menu">

<li class="parent"><a href="/02_big_data/machine_learning/">Machine Learning</a>
<ul class="sub-menu">
<li class=""><a href="/02_big_data/machine_learning/random_forest/">Random Forest</a></li>
<li class=""><a href="/02_big_data/machine_learning/bagging/">Bagging</a></li>
<li class=""><a href="/02_big_data/machine_learning/knn/">KNN</a></li>
<li class=""><a href="/02_big_data/machine_learning/linear_regression/">Linear Regression</a></li>
<li class=""><a href="/02_big_data/machine_learning/pca/">PCA</a></li>
<li class=""><a href="/02_big_data/machine_learning/train_test/">Train &amp; Test</a></li>
<li class="active"><a href="/02_big_data/machine_learning/clustering/">Clustering</a></li>
<li class=""><a href="/02_big_data/machine_learning/naive_bayes/">Naive Bayes</a></li>
</ul>
  
</li>
<li class=""><a href="/02_big_data/gan/">GAN</a></li>
<li class=""><a href="/02_big_data/tensorflow/">Tensorflow</a></li>

<li class=""><a href="/02_big_data/reinforcement_learning/">Reinforcement Learning</a>
<ul class="">
<li class=""><a href="/02_big_data/reinforcement_learning/rl_with_kg/">RL with KG</a></li>
</ul>
  
</li>

<li class=""><a href="/02_big_data/text_mining/">Text Mining</a>
<ul class="">
<li class=""><a href="/02_big_data/text_mining/regular_expression/">Regular Expression</a></li>
</ul>
  
</li>
<li class=""><a href="/02_big_data/caffe/">Caffe</a></li>
<li class=""><a href="/02_big_data/data_mining/">Data Mining</a></li>
</ul>
  
</li>

<li class=""><a href="/build_blog/">Build Blogs</a>
<ul class="">
<li class=""><a href="/build_blog/01_introduction/">Introduction</a></li>
<li class=""><a href="/build_blog/02_preparation/">Preparation</a></li>
<li class=""><a href="/build_blog/03_quick_start/">Quick Start</a></li>
<li class=""><a href="/build_blog/04_git_notes/">Git Notes</a></li>
<li class=""><a href="/build_blog/05_hugo_notes/">Hugo Notes</a></li>
<li class=""><a href="/build_blog/06_markdown_notes/">Markdown Notes</a></li>
<li class=""><a href="/build_blog/07_questions/">Q&amp;A</a></li>
<li class=""><a href="/build_blog/scoop/">Scoop</a></li>
</ul>
  
</li>

<li class=""><a href="/03_interests/">Interests</a>
<ul class="">
<li class=""><a href="/03_interests/japanese/">Japanese</a></li>
<li class=""><a href="/03_interests/hunt_for_stars/">Hunt for Stars</a></li>
<li class=""><a href="/03_interests/diy_pc/">DIY PC</a></li>
</ul>
  
</li>

<li class=""><a href="/04_reading/">Reading</a>
<ul class="">
<li class=""><a href="/04_reading/reading_notes/">Reading Notes</a></li>
<li class=""><a href="/04_reading/nonsense_output/">Nonsense Output</a></li>
<li class=""><a href="/04_reading/wisdom_from_others/">Wisdom From Others</a></li>
</ul>
  
</li>

<li class=""><a href="/mathematics/">Mathematics</a>
<ul class="">
<li class=""><a href="/mathematics/advanced_mathematical_statistics/">Mathematical Analysis</a></li>
<li class=""><a href="/mathematics/mathematical_analysis/">Mathematical Analysis</a></li>
<li class=""><a href="/mathematics/functional_analysis/">Functional Analysis</a></li>
</ul>
  
</li>

<li class=""><a href="/digital_content/">Digital Content</a>
<ul class="">
<li class=""><a href="/digital_content/opengl/">OpenGL</a></li>
<li class=""><a href="/digital_content/shader/">Shader</a></li>
<li class=""><a href="/digital_content/3dmax/">3dmax</a></li>
<li class=""><a href="/digital_content/smpl/">SMPL</a></li>
<li class=""><a href="/digital_content/image_processing/">Image Processing</a></li>
<li class=""><a href="/digital_content/affine_transformation/">Affine Transformation</a></li>
</ul>
  
</li>

<li class=""><a href="/chapter3/">Chapter 3 (hierarchized)</a>
<ul class="">
<li class=""><a href="/chapter3/1/">Chapter 3-1</a></li>

<li class=""><a href="/chapter3/chapter3-2/">Chapter 3-2</a>
<ul class="">
<li class=""><a href="/chapter3/chapter3-2/1/">Chapter 3-2-1</a></li>
<li class=""><a href="/chapter3/chapter3-2/2/">Chapter 3-2-2</a></li>
<li class=""><a href="/chapter3/chapter3-2/3/">Chapter 3-2-3</a></li>
<li class=""><a href="/chapter3/chapter3-2/4/">Chapter 3-2-4</a></li>
</ul>
  
</li>
<li class=""><a href="/chapter3/3/">Chapter 3-3</a></li>
<li class=""><a href="/chapter3/4/">Chapter 3-4</a></li>
</ul>
  
</li>

<li class=""><a href="/default_post/">Default_posts</a>
<ul class="">
<li class=""><a href="/default_post/installation/">Installation</a></li>
<li class=""><a href="/default_post/creating-a-new-theme/">Creating a New Theme</a></li>
<li class=""><a href="/default_post/migrate-from-jekyll/">Migrate to Hugo from Jekyll</a></li>
<li class=""><a href="/default_post/configuration/">Configuration</a></li>
<li class=""><a href="/default_post/goisforlovers/">(Hu)go Template Primer</a></li>
<li class=""><a href="/default_post/hugoisforlovers/">Getting Started with Hugo</a></li>
</ul>
  
</li>
</ul>
</nav>


<div class="sidebar-footer"></div>
</div>
</div><a href="#" id="backtothetop-fixed" class="backtothetop"
 data-backtothetop-duration="600"
 data-backtothetop-easing="easeOutQuart"
 data-backtothetop-fixed-fadeIn="1000"
 data-backtothetop-fixed-fadeOut="1000"
 data-backtothetop-fixed-bottom="10"
 data-backtothetop-fixed-right="20">
<span class="fa-layers fa-fw">
<i class="fas fa-circle"></i>
<i class="fas fa-arrow-circle-up"></i>
</span></a>
</div>
</body>
</html>
